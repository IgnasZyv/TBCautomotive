@using CarHostingWeb.Services


@inject NavigationManager Navigation
@inject LocalizationService Localization

<div class="admin-sidebar">
    <div class="admin-sidebar-header">
        <h5 class="mb-0">
            <i class="bi bi-gear-fill me-2"></i>
            @Localization.GetString("AdminPanel")
        </h5>
    </div>
    
    <nav class="admin-nav">
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link @GetActiveClass("/admin")" href="/admin">
                    <i class="bi bi-speedometer2 me-2"></i>
                    @Localization.GetString("AdminDashboard")
                </a>
            </li>
            
            @* <li class="nav-item"> *@
            @*     <a class="nav-link @GetActiveClass("/admin/cars")" href="/admin/cars"> *@
            @*         <i class="bi bi-car-front me-2"></i> *@
            @*         @Localization.GetString("AdminManageCars") *@
            @*     </a> *@
            @* </li> *@
            
            <li class="nav-item">
                <a class="nav-link @GetActiveClass("/admin/add-car")" href="/admin/add-car">
                    <i class="bi bi-plus-circle me-2"></i>
                    @Localization.GetString("AdminAddCar")
                </a>
            </li>
            
            @* <li class="nav-item"> *@
            @*     <a class="nav-link @GetActiveClass("/admin/reports")" href="/admin/reports"> *@
            @*         <i class="bi bi-graph-up me-2"></i> *@
            @*         @Localization.GetString("AdminReports") *@
            @*     </a> *@
            @* </li> *@
            @* *@
            @* <li class="nav-item"> *@
            @*     <a class="nav-link @GetActiveClass("/admin/settings")" href="/admin/settings"> *@
            @*         <i class="bi bi-sliders me-2"></i> *@
            @*         @Localization.GetString("AdminSettings") *@
            @*     </a> *@
            @* </li> *@
        </ul>
        
        <hr class="my-3">
        
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link" href="/">
                    <i class="bi bi-house me-2"></i>
                    @Localization.GetString("BackToSite")
                </a>
            </li>
            
            @* <li class="nav-item"> *@
            @*     <a class="nav-link text-danger" href="/logout"> *@
            @*         <i class="bi bi-box-arrow-right me-2"></i> *@
            @*         @Localization.GetString("Logout") *@
            @*     </a> *@
            @* </li> *@
        </ul>
    </nav>
</div>


@code {
    private string GetActiveClass(string href)
    {
        var currentPath = Navigation.ToBaseRelativePath(Navigation.Uri);
        
        // Exact match for admin dashboard
        if (href == "/admin" && currentPath == "admin")
            return "active";
        
        // Partial match for other admin pages
        if (href != "/admin" && currentPath.StartsWith(href.TrimStart('/')))
            return "active";
            
        return "";
    }

    protected override void OnInitialized()
    {
        Navigation.LocationChanged += OnLocationChanged;
    }

    private void OnLocationChanged(object? sender, LocationChangedEventArgs e)
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        Navigation.LocationChanged -= OnLocationChanged;
    }
}